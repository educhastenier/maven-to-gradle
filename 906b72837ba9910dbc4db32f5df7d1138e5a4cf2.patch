From 906b72837ba9910dbc4db32f5df7d1138e5a4cf2 Mon Sep 17 00:00:00 2001
From: Emmanuel Duchastenier <emmanuel.duchastenier@bonitasoft.com>
Date: Thu, 12 Jul 2018 12:07:51 +0200
Subject: [PATCH] javadoc(BOS): generate javadoc for all Community

---
 community/build.gradle | 29 +++++++++++++++++++++++++----
 1 file changed, 25 insertions(+), 4 deletions(-)

diff --git a/community/build.gradle b/community/build.gradle
index d9704a7e5c..a62e1179de 100644
--- a/community/build.gradle
+++ b/community/build.gradle
@@ -21,8 +21,9 @@ from sourceSets.main.allSource
 artifacts.archives packageSources
   repositories {
     mavenLocal()
-    
-    maven { url "http://dev.rd.lan/userContent/m2_repo/" }
+
+    maven { url "http://repositories.rd.lan/maven/releases/" }
+    maven { url "http://repositories.rd.lan/maven/snapshots/" }
     maven { url "http://repositories.rd.lan/maven/all/" }
     maven { url "https://oss.sonatype.org/content/repositories/snapshots" }
     maven { url "http://repo.maven.apache.org/maven2" }
@@ -30,6 +31,26 @@ artifacts.archives packageSources
 
   configurations.all {
 }
-  
-  
+
+
+}
+
+
+task allJavadoc(type: Javadoc) {
+    def candidates = [
+            ':platform:platform-setup',
+            ':bpm:bonita-api:bonita-common-api',
+            ':bpm:bonita-api:bonita-common-api-impl',
+            ':bpm:bonita-util:bonita-client-util'
+    ]
+    source candidates.collect { project(it).sourceSets.main.allJava }
+    classpath = files(candidates.collect { project(it).sourceSets.main.compileClasspath })
+    destinationDir = buildDir
+    failOnError = false
+    title = "Bonita Engine ${version} API"
+    options.links("https://docs.oracle.com/javase/8/docs/api/")
+    // TODO change it when SP is up and running:
+    options.stylesheetFile = new File("$projectDir/../subscription/bpm/bonita-global-javadoc/src/main/javadoc", "stylesheet.css")
+    options.overview = new File("$projectDir/../subscription/bpm/bonita-global-javadoc/src/main/javadoc", "overview.html")
+    options.bottom = "Copyright &copy; ${new Date().format('yyyy')} <a href=\"http://community.bonitasoft.com/\">Bonitasoft S.A.</a> All rights reserved."
 }
-- 
2.17.1

